<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.file.repository.MemberRepository">
	<insert id="joinMember" parameterType="member">
		<selectKey keyProperty="mem_no" resultType="long"
			order="BEFORE">
			select seq_member.nextval from dual
		</selectKey>
		insert into member (
		mem_no,
		mail,
		password,
		mem_id,
		name,
		birth,
		gender,
		phone
		) values (
		#{mem_no},
		#{mail},
		#{password},
		#{mem_id},
		#{name},
		#{birth},
		#{gender},
		#{phone}
		)
	</insert>

	<select id="findMemberByMail" resultType="member">
		select * from member
		where mail = #{mail}
	</select>

	<select id="findMemberById" resultType="member">
		select * from member
		where mem_id = #{mem_id}
	</select>

	<!-- 회원정보 전체 검색 -->

	<select id="findAllMembers" resultType="member">
		select * from member
	</select>


	<!-- 회원정보 탈퇴 -->
	<update id="deleteMember" parameterType="member">
		update member
		set status
		= '1' where mem_no=#{mem_no}

	</update>

	<!-- 개인정보 수정 -->

	<update id="updateMember">
		update member set
		password = #{password},
		name = #{name},
		mem_id = #{mem_id},
		phone = #{phone}
		where mail = #{mail}
	</update>

	<!-- 이메일 중복 확인 -->
	<select id="countByEmail" resultType="int">
		SELECT COUNT(*) FROM member
		WHERE mail = #{mail}
	</select>

	<!-- 사용자 이름 중복 확인 -->
	<select id="countByMemberId" resultType="int">
		SELECT COUNT(*) FROM
		member
		WHERE mem_id = #{mem_id}
	</select>
</mapper>